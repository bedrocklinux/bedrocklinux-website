<!doctype html>
<html lang=en>
<meta charset=utf-8>
<title>Bedrock Linux 1.0alpha1 Appa Installation Instructions</title>
<meta name=viewport content="width=device-width">
<link rel=alternate type=application/atom+xml title="Bedrock Linux Feed" href=./..//atom.xml>
<link rel=stylesheet href=./..//bedrock.css><body>
<header>
<h1 id=logo><a href=./..//><pre>__          __             __
\ \_________\ \____________\ \___
 \  _ \  _\ _  \  _\ __ \ __\   /
  \___/\__/\__/ \_\ \___/\__/\_\_\</pre>
</a></h1>
<ul id="nav">
<li><a href="../index.html">Home</a></li>
</ul>

<p>Bedrock Linux 1.0alpha1 Appa</p>

<ul id="nav">
<li><a href="index.html">Root Appa page</a></li>
<li><a href="systemrequirements.html">System Requirements</a></li>
<li><a href="knownissues.html">Known issues</a></li>
<li><a href="install.html">Installation instructions</a></li>
<li><a href="clients.html">Client setup instructions</a></li>
<li><a href="configure.html">Configuration instructions</a></li>
<li><a href="commands.html">Command overview</a></li>
</ul>

</header>
<section>
		<div id=main>

			<!-- table of contents -->

			<h1>Installation Instructions for Bedrock Linux 1.0alpha1</h1>
			<p>
				Note that there is no proper installer for Bedrock Linux
				1.0alpha1.  Installation is done by manually collecting and
				compiling the components, laying out the filesystem, adding the
				users, etc.  Experienced Linux users - those who are
				comfortable compiling their own software, know the sigificance
				of the various parts of the filesystem directory layout, etc -
				should not have overly much trouble, but those new to Linux or
				those who don't want to get their hands dirty may wish to seek
				another Linux distribution for their needs.
			</p>
			<p>
				Be sure to read the rest of the documentation relating to this
				release <a href="index.html">here</a>
			</p>
			<ol>
				<li><a href="#Installation Host Environment">Installation Host Environment</a></li>
				<li><a href="#Partitioning">Partitioning</a></li>
				<li><a href="#Mounting client distribution">Mounting client distribution</a></li>
				<li><a href="#Creating the directory structure">Creating the directory structure</a></li>
				<ol>
					<li><a href="#Optional directories">Optional directories</a></li>
				</ol>
				<li><a href="#Download core Bedrock Linux component sources">Download core Bedrock Linux component sources</a></li>
				<ol>
					<li><a href="#DOWNLOAD Linux Kernel">Linux Kernel</a></li>
					<li><a href="#DOWNLOAD Busybox">Busybox</a></li>
					<li><a href="#DOWNLOAD Syslinux">Syslinux</a></li>
					<li><a href="#DOWNLOAD Capchroot">Capchroot</a></li>
					<li><a href="#DOWNLOAD Fsck">Fsck</a></li>
					<li><a href="#DOWNLOAD Bedrock Linux Scripts">Bedrock Linux Scripts</a></li>
				</ol>
				<li><a href="#Compile core Bedrock Linux components">Compile core Bedrock Linux components</a></li>
				<ol>
					<li><a href="#COMPILE Linux Kernel">Linux Kernel</a></li>
					<li><a href="#COMPILE Busybox">Busybox</a></li>
					<li><a href="#COMPILE Syslinux">Syslinux</a></li>
					<li><a href="#COMPILE Capchroot">Capchroot</a></li>
					<li><a href="#COMPILE Fsck">Fsck</a></li>
					<li><a href="#COMPILE Bedrock Linux Scripts">Bedrock Linux Scripts</a></li>
				</ol>
				<li><a href="#Configuration files">Configuration files</a></li>
				<ol>
					<li><a href="#Add users">Add users</a></li>
					<li><a href="#Hostname">Hostname</a></li>
					<li><a href="#mdev.conf">mdev.conf</a></li>
					<li><a href="#Hosts">Hosts</a></li>
					<li><a href="#Groups">Groups</a></li>
				</ol>
				<li><a href="#Configure">Configure</a></li>
				<li><a href="#Setup First Client">Setup First Client</a></li>
				<li><a href="#Reboot and Enjoy">Reboot and Enjoy</a></li>
			</ol>

			<!-- actual main content -->

			<h2 id="Installation Host Environment">Installation Host Environment</h2>
			<p>
				First, boot a Linux distribution from a device/partition other
				than the one on which you wish to install Bedrock.  This will
				be called the "installer host." The installer host can be a
				LiveCD or LiveUSB Linux distribution (such as Knoppix or an
				Ubuntu installer), or simply a normal Linux distribution on
				another device or another partition on the same device.
			</p>
			<p>
				Be sure the installer host uses the same instruction set as you
				wish Bedrock Linux to use. Specifically, watch out for (32-bit)
				x86 live Linux distribution if you wish to make Bedrock Linux
				(64-bit) x86-64.  While it is possible have the installer host
				use a different instruction set from the targeted Bedrock, it
				is a bit more work and not covered in these instructions.
			</p>
			<p>
				If the computer on which you wish to install Bedrock Linux is
				slow, you may find it preferable to use another computer to do
				the CPU-intensive compiling.  However, this will make some
				things - such as choosing which modules to compile into the
				kernel - more difficult.  These instructions do not cover
				compiling on a separate machine from the one on which you wish
				to install.
			</p>
			<h2 id="Partitioning">Partitioning</h2>
			<p>
				Using partitioning software such as gparted or fdisk, partition
				the device on which you wish to install Bedrock.  Be very
				careful to only format bits and bytes which you no longer need
				- a mistake here could blow away another operating system with
				which you intended to dual-boot with Bedrock.
			</p>
			<p>
				For the most part you are free to partition the system however
				you please.  If you are unsure of how to partition it, it is
				reasonable to use only two partitions: (1) your main partition
				for mounting the root directory (ie, <code>/</code>) and (2) a
				swap partition.  Recommendations for swap sizes usually vary
				between equal to your RAM size to two-and-a-half times your RAM
				size.
			</p>
			<p>
				If you are comfortable with typical partitioning schemes for
				Linux - such as making <code>/boot</code>, <code>/home</code>,
				etc their own partitions - you are free to do so.  However, you
				may first want to skip down to "Creating the directory
				structure" before doing so to note some unusual aspects of
				Bedrock's layout.  Specifically, note that <code>/usr</code> is
				not heavily used.  Rather, most of the software usually in
				<code>/usr</code> will be accessed from client Linux
				distributions.  You may want to consider making
				<code>/var/chroot</code> its own partition and giving it a lot
				of space, as this is the recommended location for storing the
				client Linux distributions.
			</p>
			<p>
				Note which devices files correspond to which partitions of the
				Bedrock Linux filesystem.  These are normally located in
				<code>/dev</code>, and called <code>sdXN</code>, where
				<code>X</code> is a letter a-z and <code>N</code> is a digit
				0-9.  This information will be used later to mount these
				partitions.
			</p>
			<p>
				1.0alpha1 has only been tested with the ext2 and ext3
				filesystems, but any Linux-supported filesystem should work
				fine.  If you choose to use something other than ext2/3/4, be
				sure you know where to find (and how to set up) corresponding
				fsck software and a bootloader which can work with that
				filesystem, as these instructions will only cover ext2/3/4.
			</p>
			<p>
				If you are dual-booting with another Linux distribution, wish
				to use that distribution's bootloader, and know how to add
				Bedrock Linux to that distribution's bootloader, be sure to
				keep the boot flag on the other distribution's boot partition.
				If you would like to use Bedrock's bootloader, be sure to set
				the boot flag on the proper partition (ie, either the Bedrock's
				main/root partition or, if you made a special /boot partition,
				then the /boot partition you made).
			</p>
			<h2 id="Mounting client distribution">Mounting client distribution</h2>
			<p>
				Make a directory in which to mount Bedrock's fresh to
				partition(s).  These instructions assumes you are using
				<code>/mnt/bedrock</code> for this.  If you would like to use
				something else, be sure to change <code>/mnt/bedrock</code>
				accordingly whenever it comes up in these instructions.  Note
				that this will become Bedrock's root directory when we are
				done.  As root:
			</p>
			<pre class="rcmd">mkdir -p /mnt/bedrock</pre>
			<p>
				Mount the newly-created main/root partition.  Replace <code
				class="changethis">sdXN</code> with the corresponding device
				file to the main/root partition.  As root:
			</p>
			<pre class="rcmd">mount /dev/<code class="changethis">sdXN</code> /mnt/bedrock</pre>
			<p>
				If you created more than one partition (other than swap) for
				Bedrock, make the corresponding directories and mount them.
			</p>
			<h2 id="Creating the directory structure">Creating the directory structure</h2>
			<p>
				Create the required directory structure for Bedrock.  As root:
			</p>
			<ul class="rcmd">
			<li>cd /mnt/bedrock</li>
			<li>mkdir -p bin boot/extlinux dev etc/init.d home lib/modules opt/bedrock/bin opt/bedrock/sbin opt/bedrock/etc proc root sbin sys tmp usr/src var/lib/urandom</li>
			</ul>
			<p>
				Most of these directories should be recognizable to any
				experienced Linux user.  The one most likely to be new to
				people, <code>/var/lib/urandom</code>, will store the
				pseudo-random number generator seed between reboots so Bedrock
				doesn't have to wait for entropy when seeding it at every boot.
				<code>/opt/bedrock/</code> will contain Bedrock-specific items
				which need to be shared with client Linux distributions.
			</p>
			<p>
				Note that many directories other Linux distributions use - such
				as most of the contents of <code>/usr</code> - are missing.
				These aren't strictly necessary for the core of Bedrock;
				rather, the necessary aspects will be accessed through client
				Linux distributions.  If you'd like, you're free to make them;
				they just won't be utilized.
			</p>
			<p>
			The default permissions on most of these should be fine.  However,
			<code>/tmp</code> needs to be writable by no-root users:
			</p>
			<pre class="rcmd">chmod a+rwxt tmp</pre>
			<h3 id="Optional directories">Optional directories</h3>
			<p>
				There are a number of other directories which aren't strictly
				required but which you may want to consider.
			</p>
			<p>
				If you have hardware which requires firmware, you may want to
				create a directory in which to put the firmware.  For example,
				some wireless cards require firmware.  You could also build the
				firmware into the kernel if you choose.  If you want (external
				to the kernel) firmware, create the required directory.  As
				root:
			</p>
			<pre class="rcmd">mkdir -p lib/firmware</pre>
			<p>
				Now would be a good time to put the firmware in there, before
				you forget.
			</p>
			<p>
				Client Linux distributions can be placed just about anywhere.
				However, it is convenient to place them all in the same
				directory.  The recommended location is
				<code>/var/chroot/</code>.  As root:
			</p>
			<pre class="rcmd">mkdir -p var/chroot</pre>
			<h2 id="Download core Bedrock Linux component sources">Download core Bedrock Linux component sources</h2>
			<p>
				Download the source code to the various core components of
				Bedrock Linux to <code>/mnt/bedrock/usr/src</code>.
			</p>
			<h3 id="DOWNLOAD Linux Kernel">Linux Kernel</h3>
			<p>
				The Linux kernel can be downloaded from: <a
				href="https://www.kernel.org/">https://www.kernel.org/</a>.  If
				you don't know which version to grab, either the latest stable
				or a long-term supported kernel is a would be a good idea.
				Bedrock Linux uses (capchroot which uses) Linux capabilities,
				which puts a lower-bound on the oldest Linux kernel it can use.
				Linux 2.6.26 might be the cutoff.  1.0alpha1 was tested with
				Linux 2.6.32 - either that or anything newer than it should
				work.
			</p>
			<h3 id="DOWNLOAD Busybox">Busybox</h3>
			<p>
				Busybox can be downloaded from: <a
				href="http://www.busybox.net/">http://www.busybox.net/</a>.
				1.0alpha1 was tested successfully with busybox 1.19.4, but
				newer versions should work.
			</p>
			<h3 id="DOWNLOAD Syslinux">Syslinux</h3>
			<p>
				If you want Bedrock Linux to have its own bootloader (as
				opposed to dual-booting from another Linux distribution and
				using its bootloader), and you are using a ext2, ext3, ext4 or
				btrfs, download syslinux from: <a
				href="http://www.syslinux.org">http://www.syslinux.org</a>.
				1.0alpha1 was tested successfully with syslinux 3.86, but newer
				versions should work.
			</p>
			<p>
				Note: that syslinux is a project containing multiple
				bootloaders (one of which is syslinux).  The specific
				bootloader you probably want is "extlinux" (which supports ext2
				and ext3 filesystems, and ext4 and btrfs as of version 4) as
				the actual "syslinux" bootloader is for FAT filesystems.
				Extlinux should come packaged with syslinux.
			</p>
			<p>
				Note: syslinux/extlinux is a BIOS-based bootloader, and will
				not work with (U)EFI.  Many (U)EFI motherboards have a legacy
				BIOS-emulation mode which might work.  Otherwise, you'll have
				to find another bootloader which supports (U)EFI and figure out
				how to set it up yourself.
			</p>
			<h3 id="DOWNLOAD Capchroot">Capchroot</h3>
			<p>
				Capchroot can be downloaded from: <a
				href="https://dev.archlinux.org/~thomas/capchroot/">https://dev.archlinux.org/~thomas/capchroot/</a>
				and a patch which you will need to compile it statically can be
				found <a href=capchroot-0.1-static.patch>here</a>.
				Despite the fact that a pre-compiled version is provided as a
				.tar.gz, you should still grab the source, as minor changes
				need to be made to the source before compiling to ensure it can
				be compiled statically.
			</p>
			<p>
				1.0alpha1 was tested with capchroot 0.1.  Newer versions of
				capchroot may not necessarily work with these instructions.
			</p>
			<h3 id="DOWNLOAD Fsck">Fsck</h3>
			<p>
				You can download fsck for ext2, ext3 and ext4 at: <a
				href="http://e2fsprogs.sourceforge.net/">http://e2fsprogs.sourceforge.net/</a>
				If you would like to use another filesystem, it should not be
				difficult to find the fsck for it and install it instead, but
				these instructions do not cover it.
			</p>
			<p>
				1.0alpha1 was tested with e2fsprogs 1.42.4, but newer versions
				should work fine.
			</p>
			<h3 id="DOWNLOAD Bedrock Linux Scripts">Bedrock Linux Scripts</h3>
			<p>
				Download the Bedrock Linux scripts from <a
				href=bedrock-scripts-1.0alpha1.tar.gz>here</a>.
			</p>
			<p>
				These scripts are the ones written specifically for this
				release of Bedrock Linux (1.0alpha1).  If you would like to use
				newer or older scripts, it would be best to find the
				corresponding instructions for that version of Bedrock.
			</p>
			<h2 id="Compile core Bedrock Linux components">Compile core Bedrock Linux components</h2>
			<p>
				If you are using a LiveCD/LiveUSB, don't forget to update the
				repository index.  If you are on a Debian-based system (such as
				Knoppix or an Ubuntu installer), as root:
			</p>
			<pre class="rcmd">apt-get update</pre>
			<p>
				If you do not already have it, install the usual compiling
				packages for the distribution on which you are compiling
				Bedrock's core components.  For example, on Debian-based
				systems this would be done via (as root):
			</p>
			<pre class="rcmd">apt-get install build-essential</pre>
			<p>
				You will also be needing the ncurses development libraries.
				Again, for Debian-based systems, as root:
			</p>
			<pre class="rcmd">apt-get install libncurses5-dev</pre>
			<p>
				Or, if you foresee the need for wide characters:
			</p>
			<pre class="rcmd">apt-get install libncursesw5-dev</pre>
			<p>
				The '5' in the package name may change in the future; change
				accordingly.
			</p>
			<p>
				The Linux kernel is usually compressed.  You will have a choice
				later for which compression system to use.  You may have to
				install the corresponding libraries for that compression
				system.  The options are usually:
			</p>
			<ul>
				<li>
					Gzip
				</li>
				<li>
					Bzip2
				</li>
				<li>
					LZMA
				</li>
				<li>
					XZ
				</li>
				<li>
					LZO
				</li>
			</ul>
			<p>
				Install the requirements for the kernel to be compressed with
				the compression software you want.  For example, if you want to
				use LZO (the fastest option), and you are on a Debian-based
				system:
			</p>
			<pre class="rcmd">apt-get install lzop</pre>
			<p>
				If you would like Bedrock Linux to use its own bootloader, and
				you are not using (32-bit) x86, you will also need nasm to
				compile syslinux.  Again, for Debian-based systems as root:
			</p>
			<pre class="rcmd">apt-get install nasm</pre>
			<p>
				To compile capchroot, you also need Linux capabilities
				development libraries and setcap executable.  For a
				Debian-based system, as root:
			</p>
			<pre class="rcmd">apt-get install libcap-dev libcap2-bin</pre>
			<h3 id="COMPILE Linux Kernel">Linux Kernel</h3>
			<p>
				These instructions are not intended to be complete or
				sufficient for everyone.  It may be advisable to supplement
				this with other guides for compiling the Linux kernel.
			</p>
			<p>
				Change to the directory in which you placed the source code
				packages.
			</p>
			<pre class="cmd">cd /mnt/bedrock/usr/src</pre>
			<p>
				Unpackage the kernel source and change directories into it.
			</p>
			<ul class="cmd">
				<li>tar xvf linux-<code class="changethis">VERSION</code>.tar.bz2</li>
				<li>cd linux-<code class="changethis">VERSION</code></li>
			</ul>
			<p>
				First, it is usually a good idea to clean everything up just in
				case whoever packaged it forgot to do so before packaging.
			</p>
			<pre class="cmd">make mrproper</pre>
			<p>
				The Linux kernel's compilation configuration is usually stored
				in a file called <code>.config</code> located in the root of
				the source's directory.  If you have never compiled the Linux
				kernel before, it may be a good idea to grab the
				<code>.config</code> used by another Linux distribution.  These
				are usually stored in <code>/boot</code> with the name
				<code>config-<code class="changethis">VERSION</code></code> or
				gunzipped in <code>/proc/config.gz</code> at runtime.  If you
				want to use the one in <code>/boot</code>:
			</p>
				<pre class="cmd">cp /boot/config-<code class="changethis">VERSION</code> .config</pre>
			<p>
			Or, if you would like to use the runtime copy in /proc:
			</p>
			<ul class="cmd">
				<li>cp /proc/config.gz .</li>
				<li>gunzip config.gz</li>
				<li>mv config .config</li>
			</ul>
			<p>
				If you are experienced at compiling the Linux kernel, you
				probably have your own <code>.config</code> to reference.  Feel
				free to use that.  Just be wary that Bedrock Linux does not
				typically use a initrd.
			</p>
			<p>
				Instead of using a generic kernel which includes support for
				hardware you will not need, you can customize the kernel to
				your specific hardware.  The command <code>lsmod</code> will
				show modules the installer host has currently loaded.  As of
				Linux 2.6.32, you can have the <code>make</code> command
				automatically change .config to include the modules which are
				open (and only those modules) with the following command:
			</p>
			<pre class="cmd">make localmodconfig</pre>
			<p>
				Alternatively, if you would rather these modules be built into
				the kernel rather than loaded on-the-fly, you use the following
				command:
			</p>
			<pre class="cmd">make localyesconfig</pre>
			<p>
				If the kernel you are about to compile contains features the
				reference .config doesn't mention, you may be prompted for what
				to do with the new options after <code>make
				localmodconfig/localyesconfig</code>.  If you do not want to
				think about each item, the defaults are usually safe - you can
				just hold down the <code>ENTER/RETURN</code> key here until the
				prompts stop.  You will have the chance to change these later
				with <code>make menuconfig</code>.
			</p>
			<p>
				Note that these two commands often leave in some things as
				modules which aren't loaded, such as some webcam, videocard and
				soundcard modules.  If you know with a high degree of
				confidence which drivers your kernel uses and which it does
				not, you may still want to go through menuconfig below and
				remove some items these two commands leave behind.
			</p>
			<p>
				Note that these commands will leave out most modules which is
				not currently loaded.  For example, if you do not have any USB
				mass storage devices plugged in when running the commands,
				support for USB mass storage may be removed from the
				<code>.config</code>.  It can be re-added manually with
				<code>make menuconfig</code> below.
			</p>
			<p>
				Note that not only can modules be loaded on-the-fly, they can
				also be removed on-the-fly, unlike anything compiled in.  If,
				for example, you wish to switch between nouveau and the
				proprietary nVidia drivers, you will want to ensure nouveau is
				a module and not built-in.
			</p>
			<p>
				Note that compile time can be improved drastically be only
				compiling the parts of the kernel your hardware will actually
				use.  However, if you later add new hardware, you will have to
				recompile the kernel.
			</p>
			<p>
				If you would like, you can compile the firmware directly into
				the kernel.  If so, place the firmware in the
				<code>firmware</code> directory in the root of the unpackaged
				Linux kernel source.
			</p>
			<p>
				To further customize the kernel, run the following command:
			</p>
			<pre class="cmd">make menuconfig</pre>
			<p>
				This will compile a very small program which acts as a menu to
				help you configure the Linux kernel.
			</p>
			<p>
			Controls:
			</p>
			<ul>
				<li>
				Move the selected line with the arrow keys.
				</li>
				<li>
				<code>ENTER/RETURN</code> to select something (such as entering a sub-level of
				the menu).
				</li>
				<li>
				Hit <code>ESCAPE</code> twice to go up a level.
				</li>
				<li>
				<code>Y</code> will mark a component to be built-in.
				</li>
				<li>
				<code>M</code> will mark a component to be built as an external module.
				</li>
				<li>
				<code>N</code> will mark a component not to be compiled (excluded).
				</li>
				<li>
				<code>?</code> will provide help about the item under the cursor.  This can be
				quite helpful for determining when change something away from
				defaults.
				</li>
				<li>
				<code>/</code> can be used to search.
				</li>
			</ul>
			<p>
				Recommended changes:
			</p>
			<p>
				If you want to use a initramfs/initrd, you will have to find
				other instructions on how to do so.  These instructions assume
				no initrd/initramfs.  With that in mind, set the following to
			excluded:
			</p>
			<pre>General Setup ---></pre>
			<pre>	Initial RAM filesystem and RAM disk support</pre>
			<p>
				If you chose to use a <code>.config</code> from another Linux
				distribution, and you did not use <code>make
				localyesconfig</code> above, there is a chance that the kernel
				does not have everything you need to boot built-in.  It might
				have been intended to load some things from within an initial
				ramdisk.  Use <code>lsmod</code> to see loaded modules, and
				find any that looks necessary to (1) boot and (2) read the
				external modules from the filesystem - such code for  ext2/3/4/
				filesystems or SCSI/IDE/SATA drivers - and ensure they are
				built-in, unless you plan to make your own initramfs/initrd (by
				finding instructions elsewhere).
			</p>
			<p>
			The Linux kernel has minimal support for in-kernal maintaining of
			<code>/dev</code> through a feature called "devtmpfs".  Bedrock
			Linux uses busybox's mdev for this purpose, making devtmpfs
			unnecessary. Set the following to excluded:
			</p>
			<pre>Device Drivers -></pre>
			<pre>	Generic Driver Options ---></pre>
			<pre>		Maintain a devtmpfs filesystem to mount at /dev</pre>
			<p>
				If you want to compile multiple kernels of the same kernel
				version (such as trial-and-error on getting something to work),
				creating a local version is helpful.
			</p>
			<pre>General Setup ---></pre>
			<pre>	Local version - append to kernel release</pre>
			<pre>General Setup ---></pre>
			<pre>	Automatically append version information to the version string</pre>
			<p>
			If you have firmware you wish to install into directly into the kernel, and you
			placed it into the "firmware" directory as explained earlier, specify the
			filename of the firmware at
			</p>
			<pre>Device Drivers -></pre>
			<pre>Generic Driver Options ---></pre>
			<pre>External firmware blobs to build into the kernel binary</pre>
			<p>
				As of Linux 3.4, Linux now has a security module called "Yama"
				which can be used to lock down ptrace.  If you want to use
				Bedrock's chroot system to attempt to do sandboxing, be sure to
				enable Yama support to protect against possible attacks from
				the sandboxed command via ptrace.  This is probably a good idea
				even if you don't intend to do any special sandboxing.
				Build-in the following:
			</p>
			<pre>Security options ---></pre>
			<pre>	Yama Support</pre>
			<p>
				If you want to ensure it is enabled by default, set it as the
				Default security module:
			</p>
			<pre>Security options ---></pre>
			<pre>	Default security module</pre>
			<p>
				Once you have finished selecting the options you want in
				menuconfig, save and exit it.
			</p>
			<p>
				To compile, run:
			</p>
			<pre class="cmd">make</pre>
			<p>
				Depending on the options you have selected and your machines
				performance, this can take quite a while.
			</p>
			<p>
				Next, you need to install the kernel into Bedrock.  Two
				environmental variables can be set to tell <code>make</code>
				where to install the modules and kernel itself.  If you are not
				using <code>/mnt/bedrock</code> as the mount point for Bedrock,
				change the relevant part of the lines below:
			</p>
			<p>
				Install the external modules:
			</p>
			<pre class="rcmd">INSTALL_MOD_PATH=/mnt/bedrock make modules_install</pre>
			<p>
				Install the kernel itself:
			</p>
			<pre class="rcmd">INSTALL_PATH=/mnt/bedrock/boot make install</pre>
			<p>
				If you see errors about grub after this command, you are free
				to disregard them.  Just ensure that
				<code>/mnt/bedrock/boot</code> has, at least, two files:
				<code>vmlinuz-<code class="changethis">KERNEL-VERSION</code></code> and
				<code>System.map-<code class="changethis">KERNEL-VERSION</code></code>.  You may also have
				<code>config-<code class="changethis">KERNEL-VERSION</code></code>, which you can later use
				as a new <code>.config</code> to create a new kernel.
			</p>
			<p>
				Installing the modules created  two symlinks which will break
				when Bedrock's root filesystem is mounted as <code>/</code>
				rather than <code>/mnt/bedrock</code>.  To fix this, delete and
				manually re-create the pointing to the correct location.
			</p>
			<ul class="rcmd">
				<li>rm /mnt/bedrock/lib/modules/<code class="changethis">KERNEL-VERSION</code>/build</li>
				<li>rm /mnt/bedrock/lib/modules/<code class="changethis">KERNEL-VERSION</code>/source</li>
				<li>ln -s /usr/src/linux-<code class="changethis">KERNEL-VERSION</code> /mnt/bedrock/lib/modules/<code class="changethis">KERNEL-VERSION</code>/build</li>
				<li>ln -s /usr/src/linux-<code class="changethis">KERNEL-VERSION</code> /mnt/bedrock/lib/modules/<code class="changethis">KERNEL-VERSION</code>/source</li>
			</ul>
			<p>
				Be careful to use the proper <code
				class="changethis">KERNEL-VERSION</code> in the above commands.
				The terms starting with <code>/mnt/bedrock</code> should be
				tab-completable depending on your shell, but the
				<code>/usr/src/linux-<code
				class="changethis">KERNEL-VERSION</code></code> will need the
				name of the directory which contains the Linux kernel's source
				code without the <code>/mnt/bedrock</code> prefix.
			</p>
			<h3 id="COMPILE Busybox">Busybox</h3>
			<p>
				Change to the directory in which you placed the source code packages.
			</p>
			<pre class="cmd">cd /mnt/bedrock/usr/src</pre>
			<p>
				Unpackage the busybox source and change directories into it:
			</p>
			<ul class="cmd">
				<li>tar xvf busybox-<code class="changethis">VERSION</code>.tar.bz2</li>
				<li>cd busybox-<code class="changethis">VERSION</code></li>
			</ul>
			<p>
				Configuring busybox is very similar to configuring the Linux
				kernel.  To get the configuration menu, run:
			</p>
			<pre class="cmd">make menuconfig</pre>
			<p>
				The navigating and otherwise using the menu is the same the
				Linux kernel configuration.
			</p>
			<p>
				Recommended configurations:
			</p>
			<p>
				Bedrock Linux uses busybox for nearly the entirety of its
				userland.  While most of the functionality will be acquired
				through client Linux distributions, it may still be beneficial
				to treat Bedrock Linux as a full-blown desktop when it is not
				much additional work extra work.  Enable:
			</p>
			<pre>Busybox Settings ---></pre>
			<pre>	General Configuration ---></pre>
			<pre>		Enable options for full-blown desktop systems</pre>
			<p>
				You will use the <code>--install</code> flag to install
				busybox's applets.  Ensure this flag is available by enabling:
			</p>
			<pre>Busybox Settings ---></pre>
			<pre>	General Configuration ---></pre>
			<pre>		Support --install [-s] to install applet links at runtime</pre>
			<p>
				There is minimal benefit to using <code>/usr</code> with
				Bedrock, only additional complexity.  Enable:
			</p>
			<pre>Busybox Settings ---></pre>
			<pre>	General Configuration ---></pre>
			<pre>		Don't use /usr</pre>
			<p>
				Making busybox a static binary makes both installation and
				updating by compiling in a client Linux distribution much
				easier.  Enable:
			</p>
			<pre>Busybox Settings ---></pre>
			<pre>	Build Options ---></pre>
			<pre>		Build BusyBox as a static binary (no shared libs)</pre>
			<p>
				Recommended applets:
			</p>
			<p>
				At the moment, there is no list of exactly what parts of
				busybox Bedrock Linux requires.  If you are worried that you
				might leave something out which Bedrock Linux requires, a
				viable strategy could be to simply be easiest to install just
				about everything in Applets (ie, everything not under "Busybox
				Settings --->").  This is not required, and if you're familiar
				with what is typically expected in a Linux distribution, you're
				free to limit busybox's applets to simply that.
			</p>
			<p>
			To compile, run:
			</p>
			<pre class="cmd">make</pre>
			<p>
				Note that a number of testers have reported substancial trouble
				compiling busybox statically on various Linux distributions
				with the instructions provided above. You may very well receive
				warnings along the lines of "statically linked applications
				requires at the runtime the shared libraries from the glibc
				verion used for linking".  If this happens to you, you have
				several options available:
			</p>
			<ul>
				<li>
					You could try disabling busybox applets in <code>make
					menuconfig</code> - specifically, look at networking
					applets.  If you remove the specific functionality your
					libc does not want to provide statically, things might go
					smoothly from that point.
				</li>
				<li>
					You could find a pre-made static busybox.  This is often
					available in the repositories of many Linux distributions.
					You can install it from there and simply copy it.
				</li>
				<li>
					You could look into finding a libc which supports
					statically-linking the required features, such as uclibc.
					<a href="http://buildroot.uclibc.org/">Buildroot</a>
					provdies a relatively easy means to compile busybox against
					uclibc and may be worth looking into.
				</li>
			</ul>
			<p>
				A high-priority goal for an up release of Bedrock Linux will
				be to include a more consistent, installer host distro-agnostic
				solution for statically compiling buysbox.
			</p>
			<p>
				To confirm that it was compiled statically, run
			</p>
			<pre class="cmd">ldd busybox</pre>
			<p>
				and check that the output is "not a dynamic executable".  To
				install it, copy the binary to its new home:
			</p>
			<pre class="rcmd">cp busybox /mnt/bedrock/bin/</pre>
			<p>
				Note that some commands which busybox will provide for us (such
				as <code>su</code> and <code>ping</code>) need to be setuid.
				The only way to achieve this is to setuid busybox itself.
				Busybox will drop permissions if it is called as an applet that
				does not need setuid.  If you are worried about this, go back
				and create two busybox executables - one for things that need
				setuid and one for things that do not.  To setuid busybox, as
				root:
			</p>
			<pre class="rcmd">chmod +s /mnt/bedrock/bin/busybox</pre>
			<p>
				Busybox is a single executable that, when called with a
				different name, can act like other Linux userland utilities.
				To make it act like those other command transparently, we need
				to make other files which point to busybox.  Busybox can create
				these itself with the <code>--install</code> flag.  We must
				ensure busybox installs with the assumption that /mnt/bedrock
				is the root filesystem via chroot.  As root:
			</p>
			<pre class="rcmd">chroot /mnt/bedrock /bin/busybox <code>--install</code></pre>
			<p>
				If you made a separate busybox for setuid-only things, be sure
				to <code>--install</code> it as well.
			</p>
			<p>
				Note that, depending on the libraries used when compiling
				busybox, it may not be completely statically linked.  For
				example, it may be lacking the ability to resolve DNS
				information.  Before testing this, copy
				<code>/etc/resolv.conf</code> from your host into
				<code>/mnt/bedrock/etc/</code>, as this file is required to
				resolve DNS.  Once that is done, you can try to see you can
				successfully use busybox to ping:
			</p>
			<pre class="rcmd">chroot /mnt/bedrock /bin/busybox ping google.com</pre>
			<p>
				If this fails, try see if it succeeds from outside of the
				chroot:
			</p>
			<pre class="rcmd">/mnt/bedrock/bin/busybox ping google.com</pre>
			<p>
				If it works outside of the chroot, but not inside, you have the
				option of copying the libraries from the installer host into
				the bedrock chroot, or simply live without the ability to
				resolve DNS in the core Bedrock Linux (this is a relatively
				minor issue since you can use a client for just about anything
				you would need).  If you would like to copy the libraries from
				the installer host, use strace against both above commands (ie,
				inside and outside of the chroot) and determine which libraries
				busybox from outside can see and use but it can't from inside
				and copy them over.
			</p>
			<h3 id="COMPILE Syslinux">Syslinux</h3>
			<p>
				Again, as a reminder, "syslinux" is the name of a project which
				contains several bootloaders, one of which is also called
				"syslinux."  If you want Bedrock Linux to have its own
				bootloader, the specific bootloader from the syslinux project
				you most likely want to use is called "extlinux" and can be
				used with ext2 or ext3 (and as of version 4, ext4 and the btrfs
				filesystem).
			</p>
			<p>
				If you want to dual-boot with another operating system and you
				know how to add Bedrock Linux to that other operating system,
				feel free to skip the this section of the instructions and
				simply add Bedrock Linux to your other operating system's
				bootloader.  Be careful when installing syslinux, as if it is
				done improperly (either by not following these directions
				correctly, or by a fault in these directions), it could leave
				your system broken and unbootable.  Practicing/testing in a VM
				is not a bad idea if you are worried.
			</p>
			<p>
				It may be a good idea to read other guides on installing
				syslinux/extlinux to supplement this guide, just in case, and
				to skim the entirety of this section before starting to follow
				any of it.
			</p>
			<p>
				From this point onward, avoid shutting down the installer host
				part-way through these instructions unless you are using a
				LiveUSB/LiveCD system.  Otherwise you may have difficulty
				booting.
			</p>
			<p>
				Change to the directory in which you placed the source code
				packages.
			</p>
			<pre class="cmd">cd /mnt/bedrock/usr/src</pre>
			<p>
			Unpackage syslinux and change directories into the extlinux subdirectory in it:
			</p>
			<ul class="cmd">
				<li>tar xvf syslinux-<code class="changethis">VERSION</code>.tar.gz</li>
				<li>cd syslinux-<code class="changethis">VERSION</code></li>
			</ul>
			<p>
				If you are using (32-bit) x86, you may use the compiled binary
				the package which comes with the package.  Otherwise, you will
				have to compile extlinux it yourself.  If you are not using
				(32-bit) x86 (or you would like to compile syslinux for another
				reason), run the following:
			</p>
			<pre class="cmd">make clean; make</pre>
			<p>
				This will compile a number of things you do not need.  If you
				receive an error, there is a good chance that it was not with
				regards to extlinux.  Check to see if extlinux compiled
				successfully:
			</p>
			<pre class="cmd">ls extlinux/extlinux</pre>
			<p>
				Install syslinux/extlinux.  As root:
			</p>
			<pre class="rcmd">extlinux/extlinux --install /mnt/bedrock/boot/extlinux</pre>
			<p>
				Note that, unlike with busybox, we do not want to use chroot to
				make <code>/mnt/bedrock</code> appear as the root directory.
			</p>
			<p>
				Although syslinux is installed on the partition, it still needs
				to be properly set up on the harddrive itself.  Find the
				corresponding device file for device you made bootable when you
				partitioned/formatted earlier.  Note that here we aren't
				looking for the partition device file - <code>/dev/sdXN</code>
				- but rather the device's file - <code>/dev/sdX</code>.  There
				should be no 0-9 digit in the filename.  As root:
			</p>
			<pre class="rcmd">cat mbr/mbr.bin > /dev/<code class="changethis">sdX</code> # change X accordingly</pre>
			<p>
				You may now want to copy several files to
				<code>/mnt/bedrock/boot/extlinux</code> which syslinux needs
				for some of its features.
			</p>
			<p>
				To use a simple menu when booting (as opposed to a
				commandline), copy <code>menu.c32</code>
			</p>
			<pre class="rcmd">cp com32/menu/menu.c32 /mnt/bedrock/boot/extlinux</pre>
			<p>
				Or, if you'd prefer a fancy graphical menu, copy <code>vesamenu.c32</code>
			</p>
			<pre class="rcmd">cp com32/menu/vesamenu.c32 /mnt/bedrock/boot/extlinux</pre>
			<p>
				To be able to poweroff from the boot menu (or commandline), copy <code>poweroff.com</code>:
			</p>
			<pre class="cmd">cp modules/poweroff.com /mnt/bedrock/boot/extlinux</pre>
			<p>
				Note that on <code>poweroff.com</code> does not seem to work
				across all computers.
			</p>
			<p>
				To have "reboot" as a menu option, copy <code>reboot.c32</code>
			</p>
			<pre class="rcmd">cp com32/modules/reboot.c32 /mnt/bedrock/boot/extlinux</pre>
			<p>
				Note that you can reboot with ctrl-alt-delete without
				<code>reboot.c32</code>.
			</p>
			<p>
				To chain-load another operating system's bootloader (such as Microsoft
				Windows), you will need <code>chain.c32</code>.
			</p>
			<pre class="rcmd">cp com32/modules/chain.c32 /mnt/bedrock/boot/extlinux</pre>
			<p>
				Now you should create the configuration file for syslinux.
				Unlike GRUB, syslinux must be configured by hand.  Assuming you
				want a graphical menu, run the following to get a basic menu in
				syslinux:
			</p>
			<pre class="rcmd">cat > /mnt/bedrock/boot/extlinux/extlinux.conf << EOF
UI menu.c32
MENU TITLE Syslinux Bootloader
DEFAULT Bedrock
PROMPT 0
TIMEOUT 50
LABEL Bedrock
MENU LABEL Bedrock Linux 1.0alpha1
LINUX ../vmlinuz-<code class="changethis">KERNEL-VERSION</code>
APPEND root=/dev/<code class="changethis">sdXN</code> quiet ro
EOF
			</pre>
			<p>
				Be sure to change <code
				class="changethis">KERNEL-VERSION</code> to the version of the
				Linux kernel you compiled earlier so that
				<code>../vmlinuz-<code
				class="changethis">KERNEL-VERSION</code></code> after the
				change will point the vmlinuz file you created when installing
				the Linux kernel.  Also be sure to change <code
				class="changethis">sdXN</code> to the partition you set to boot
				- either Bedrock's main/root partition or it's /boot partition
				if you made one.  You may also change <code>menu.c32</code> to
				<code>vesamenu.c32</code> if you prefer.
			</p>
			<p>
				If you would like to dual-boot with Windows, append the following:
			</p>
<pre class="rcmd">cat >> /mnt/bedrock/boot/extlinux/extlinux.conf << EOF
LABEL Windows
MENU LABEL Windows
COM32 chain.c32
APPEND <code class="changethis">hdN N</code>
EOF
</pre>
			<p>
				Be sure to change the <code class="changethis">N</code>'s in
				<code class="changethis">hdN N</code> to the harddrive number
				(zero-indexed) and partition number (also zero-indexed) of the
				Windows bootloader.  Note that Windows 7 (and probably Vista
				before it) usually comes with a roughly 100MB "System Reserved"
				partition, and so the actual partition you would like to boot
				for Windows is usually not the first partition.  For example,
				Windows 7 is the only OS on the first harddrive, you probably
				want to use <code>hd0 1</code>.  If you get it wrong, you can
				change it and try again (either from within Bedrock, or from a
				LiveCD/LiveUSB).
			</p>
			<p>
				If you would like, feel free to add entries for other operating
				systems or customize the colors or other options of syslinux.  For
				example, to customize the menu provided by menu.c32, see <a
				href="http://www.syslinux.org/wiki/index.php/Comboot/menu.c32">here</a>.
			</p>
			<h3 id="COMPILE Capchroot">Capchroot</h3>
			<p>
				Change to the directory in which you placed the source code
				packages.
			</p>
			<pre class="cmd">cd /mnt/bedrock/usr/src</pre>
			<p>
				Unpackage the capchroot source and change directories into it:
			</p>
			<ul class="cmd">
				<li>tar xvf capchroot-0.1.tar.gz</li>
				<li>cd capchroot-0.1</li>
			</ul>
			<p>
			patch capchroot:
			</p>
			<pre class="cmd">patch -p1 < ../capchroot-0.1-static.patch</pre>
			<p>
				This patch allows capchroot to be compiled statically-linked,
				and moves the config file for capchroot to
				<code>/opt/bedrock/etc/</code>, making it easier to share with
				client Linux distributions.
			</p>
			<p>
				Compile capchroot:
			</p>
			<pre class="cmd">LDFLAGS=-static make</pre>
			<p>
				To confirm that it was compiled statically, run
			</p>
			<pre class="cmd">ldd capchroot</pre>
			<p>
				and check that the output is "not a dynamic executable".
			</p>
			<p>
				To install it, simply copy it to what will be Bedrock's
				<code>/opt/bedrock/bin</code> (as root):
			</p>
			<pre class="rcmd">cp capchroot /mnt/bedrock/opt/bedrock/bin</pre>
			<p>
				Lastly, you will need to set the Linux capabilities permissions
				on capchroot so that it can allow non-root users to chroot.
			</p>
			<pre class="rcmd">setcap cap_sys_chroot=ep /mnt/bedrock/opt/bedrock/bin/capchroot</pre>
			<h3 id="COMPILE Fsck">Fsck</h3>
			<p>
				Change to the directory in which you placed the source code
				packages.
			</p>
			<pre class="cmd">cd /mnt/bedrock/usr/src</pre>
			<p>
				Unpackage the fsck source and change directory into it:
			</p>
			<ul class="cmd">
			<li>tar xvf e2fsprogs-<code class="changethis">VERSION</code>.tar.gz</li>
			<li>cd e2fsprogs-<code class="changethis">VERSION</code></li>
			</ul>
			<p>
				Create a build directory and change directory into it:
			</p>
			<ul class="cmd">
				<li>mkdir build</li>
				<li>cd build</li>
			</ul>
			<p>
				Compile fsck:
			</p>
			<ul class="cmd">
				<li>LDFLAGS=-static ../configure</li>
				<li>LDFLAGS=-static make</li>
			</ul>
			<p>
			To confirm that it was compiled statically, run
			</p>
			<pre class="cmd">ldd e2fsck/e2fsck</pre>
			<p>
				and check that the output is "not a dynamic executable".
			</p>
			<p>
				To install it, simply copy it to what will be Bedrock's <code>/sbin</code>
				with the names of the filesystems it supports (as root):
			</p>
			<ul class="rcmd">
				<li>cp e2fsck/e2fsck /mnt/bedrock/sbin/fsck.ext2</li>
				<li>cp e2fsck/e2fsck /mnt/bedrock/sbin/fsck.ext3</li>
				<li>cp e2fsck/e2fsck /mnt/bedrock/sbin/fsck.ext4</li>
			</ul>
			<h2 id="COMPILE Bedrock Linux Scripts">Bedrock Linux Scripts</h2>
			<p>
				Unpackage the Bedrock Linux scripts over the soon-to-be Bedrock
				Linux root.
			</p>
			<ul class="rcmd">
				<li>cd /mnt/bedrock</li>
				<li>tar xvf usr/src/bedrock-scripts-1.0alpha1.tar.gz</li>
			</ul>
			<p>
			This will install the following:
			</p>
			<ul>
				<li>
					The init configuration (<code>/etc/inittab</code>)
				</li>
				<li>
					The init scripts (<code>/etc/init.d/rcS</code>, <code>rcK</code>, <code>rcS.clients</code> and <code>rcK.clients</code>)
				</li>
				<li>
					Bedrock Linux <code>rc.conf</code>
					(<code>/opt/bedrock/etc/rc.conf</code>)
				</li>
				<li>
					A (largely blank) Bedrock Linux clients config
					(<code>/opt/bedrock/etc/brclients.conf</code>)
				</li>
				<li>
					A (largely blank) capchroot allow config (<code>/opt/bedrock/etc/capchroot.allow</code>)
				</li>
				<li>
					The login script (<code>/etc/profile</code>)
				</li>
				<li>
					A (largely blank) filesystem table (<code>/etc/fstab</code>)
				</li>
				<li>
					The Bedrock Linux meta-shell
					(<code>/opt/bedrock/bin/brsh</code>)
				</li>
				<li>
					The Bedrock Linux chroot wrapper
					(<code>/opt/bedrock/bin/brc</code>)
				</li>
				<li>
					The Bedrock Linux chroot setup script
					(<code>/opt/bedrock/bin/brs</code>)
				</li>
				<li>
					The Bedrock Linux script to run a command in all clients
					(<code>/opt/bedrock/bin/brl</code>)
				</li>
				<li>
					The Bedrock Linux script which determines in which client
					it is being run (<code>/opt/bedrock/bin/brw</code>)
				</li>
				<li>
					The Bedrock Linux path hashing script
					(<code>/opt/bedrock/sbin/brp</code>)
				</li>
				<li>
					The Bedrock Linux client updating script
					(<code>/opt/bedrock/sbin/bru</code>)
				</li>
				<li>
					A library for the various Bedrock Linux scripts to
					reference (<code>/opt/bedrock/lib/brfunctions</code>)
				</li>
				<li>
					Versions of halt, poweroff and reboot which will work with Bedorck's init (/<code>opt/bedrock/sbin/halt</code>, <code>poweroff</code> and <code>reboot</code>)
				</li>
			</ul>
			<h2 id="Configuration files">Configuration files</h2>
			<p>
				All of configuration files will be created from within Bedrock
				Linux via a chroot, as root.
			</p>
			<p>
				Chroot into Bedrock Linux (as root):
			</p>
			<pre class="rcmd">chroot /mnt/bedrock /bin/sh</pre>
			<h3 id="Add users">Add users</h3>
			<p>
			Create the global user-management files (as root):
			</p>
			<ul class="rcmd">
				<li>touch /etc/passwd</li>
				<li>touch /etc/group</li>
				<li>touch /etc/shadow</li>
			</ul>
			<p>
				Create the root user (as root):
			</p>
			<pre class="rcmd">adduser root -u 0 -h /root -s /opt/bedrock/bin/brsh -D</pre>
			<p>
				Set the password:
			</p>
			<pre class="rcmd">passwd -a sha512</pre>
			<p>
				You can configure brsh to use either a shell from a client
				distribution or Bedrock's <code>/bin/sh</code>.  If you would
				typically prefer to log into a client distribution's shell, but
				occasionally would like to log into Bedrock's
				<code>/bin/sh</code>, it may be easier to create another login
				which uses a different shell so you are not forced to log in,
				change brsh's configuration, then log out, then log back in.
				Moreover, this is a good backup option in case brsh fails to
				recognize that a client's shell is not working properly.  To
				ensure root remains available quickly and easily in these
				situations, create another user (brroot) with the same UID
				which uses bedrock's busybox's <code>/bin/sh</code>.
			</p>
			<ul class="rcmd">
				<li>cat /etc/passwd | sed 's/^root:/br&/' | sed 's,:[^:]*$,:/bin/sh,' >> /etc/passwd</li>
				<li>cat /etc/shadow | sed 's/^root:/br&/' >> /etc/shadow</li>
			</ul>
			<p>
			If you would like to add other users, run the following for each user:
			</p>
			<ul class="rcmd">
				<li>adduser <code class="changethis">USERNAME</code> -s /opt/bedrock/bin/brsh -D</li>
				<li>passwd -a sha512 <code class="changethis">USERNAME</code></li>
			</ul>
			<p>
				If you would like to ensure the users have two logins - one
				normal one and one for directly logging into Bedrock's
				<code>/bin/sh</code> without having to reconfigure brsh, run
				the following, changing <code
				class="changethis">USERNAME</code> to the user's name.
			</p>
			<ul class="rcmd">
				<li>cat /etc/passwd | sed 's/^<code class="changethis">USERNAME</code>:/br&/' | sed 's,:[^:]*$,:/bin/sh,' >> /etc/passwd</li>
				<li>cat /etc/shadow | sed 's/^<code class="changethis">USERNAME</code>:/br&/' >> /etc/shadow</li>
			</ul>
			<h3 id="Shells">Shells</h3>
			<p>
				Create the /etc/shells file
			</p>
			<ul class="rcmd">
				<li>echo "/bin/sh" > /etc/shells</li>
				<li>echo "/opt/bedrock/bin/brsh" >> /etc/shells</li>
			</ul>
			<h3 id="Hostname">Hostname</h3>
			<p>
				Create the hostname.
			</p>
			<pre class="rcmd">echo "<code class="changethis">HOSTNAME</code>" > /etc/hostname</pre>
			<h3 id="mdev.conf">mdev.conf</h3>
			<p>
				The device files in <code>/dev</code> are maintained by
				busybox's mdev.  This requires a configuration file, mdev.conf.
				The one used by the good folks at Linux From Scratch is
				adequate for Bedrock.
			</p>
			<p>
				Run the instructions for creating mdev.conf in Cross Linux From
				Scratch as provided <a
				href="http://cross-lfs.org/view/clfs-embedded/x86/bootscripts/mdev.html">here</a>.
			</p>
			<p>
				Note that, since we do did not create a <code>$CLFS</code>
				variable and we are in the chroot, it should create it in the
				proper place.  Just in case, ensure that, from within the
				chroot, the file is located at <code>/etc/mdev.conf</code> and
				that, from outside of the chroot, the file is located at
				<code>/mnt/bedrock/etc/mdev.conf</code>.
			</p>
			<p>
				The as of the time of writing, the mdev.conf used by CLFS
				expects several scripts to be present in /lib/mdev.  No work
				has yet been made to ensure this works with Bedrock.  Instead,
				simply comment out any part which mentions
				<code>/lib/mdev</code> - but only that term and those following
				it, not the terms before it.
			</p>
			<p>
				For example, change
			</p>
			<pre class="file">sd[a-z].* root:disk 0660 */lib/mdev/usbdisk_link</pre>
			<p>
				to
			</p>
			<pre class="file">sd[a-z].* root:disk 0660 #*/lib/mdev/usbdisk_link</pre>
			<h3 id="Hosts">Hosts</h3>
			<p>
				Create the hosts file:
			</p>
			<ul class="rcmd">
				<li>echo "127.0.0.1 localhost" > /etc/hosts</li>
				<li>echo "127.0.0.1 $(cat /etc/hostname)" >> /etc/hosts</li>
			</ul>
			<h3 id="Groups">Groups</h3>
			<p>
				Mdev expects certain users and groups to be present when it
				populates <code>/dev</code> in order to give these the proper
				ownership.  You can create the groups to satisfy mdev, or - if
				you don't care to have mdev use special rules when creating the
				devices - you can remove the lines which expect non-existant
				groups from <code>/etc/mdev.conf</code>.  To create the groups
				it expects, as root:
			</p>
			<ul class="rcmd">
				<li>addgroup -g 5  tty</li>
				<li>addgroup -g 6  disk</li>
				<li>addgroup -g 20 dialout</li>
				<li>addgroup -g 24 cdrom</li>
				<li>addgroup -g 25 floppy</li>
				<li>addgroup -g 29 audio</li>
				<li>addgroup -g 44 video</li>
			</ul>
			<p>
				If your mdev.conf also includes other groups not mentioned
				here, feel free to include those as well.  Moreover, if you
				later choose to use udev instead of mdev, it too may have
				certain expections about available groups.  It may be wise to
				reference the group numbers other distributions use.
			</p>
			<p>
				You may exit the chroot.  At this point, the core of Bedrock
				Linux is finished installing, and the system should be
				bootable.  The rest of these instructions can be done from
				within or without of the chroot, from the installer host or
				from Bedrock itself.  However, remember that there may be some
				difficulties getting network access from the core of Bedrock
				without a client yet installed.  Moreover, be careful about the
				paths described in the following instructions, as the exact
				paths will change depending on whether or not you are in the
				installer host, within the chroot, from the core of Bedrock, or
				from a client.
			</p>
			<h2 id="Configure">Configure</h2>
			<p>
				Configure Bedrock Linux as per the instructions made available
				<a href="configure.html">here</a>.
			</p>
			<h2 id="Setup First Client">Setup First Client</h2>
			<p>
				Bedrock Linux does not do very much by itself without any
				client Linux distributions.  Before booting into Bedrock, it
				may be wise to use the installer host to get your first client.
			</p>
			<p>
				See the <a href=clients.html>clients</a> page on details for
				setting up a specific Linux distribution.
			</p>
			<h2 id="Reboot and Enjoy">Reboot and Enjoy</h2>
			<p>
				If you wish to use another bootloader, be sure to set up
				Bedrock Linux in that bootloader.
			</p>
			<p>
				Finally, reboot into Bedrock Linux and enjoy!
			</p>
		</div>

</section>
<footer>
<p> <a href=/>Bedrock Linux</a> 2012-2013
</footer>
</html>
